# Кеширование

Имеет смысл внедрения как http кеширования для просмотра заказов в админке, так и кеширования на уровне MES, для ускорения отклика системы.

### 1. Мотивация

Приходят жалобы от операторов: когда они заходят на первую страницу MES, система долго прогружается. Учитывая, что MES - это админка и бекенд сервис, реализация как http кеширования, так и кеширвоания на уровне бекенда будет иметь смысл.

Кеширование поможет:
- Снизить время отклика системы
- Увеличить скорость обработка заказов операторами

### 2. Предлагаемое решение

Для http кеширования нет смысла делать кеширование по времени - данные могут обновляться динамически. Поэтому есть вариант работать с заголовком Cache-Control: no-cache и If-None-Match с проверкой ETag с кешированием на стороне бекенда. При этом при получении запроса необходимо проверять актуальность данных. Для этого можно отправить запрос в базу для получения последнего изменения записи с учетом пагинации по нужным записям. Если последнее время равно ETAG - возвращаем 304 Not Modified. Если время изменения изменилось - запрашиваем обновленные данные. Учитывая, что данные могут меняться часто, но не каждую секунду\минуту, а операторы часто запрашивают ресурс - такого рода кеширование пригодится.

В дополнение к http кешированию можно реализовать паттерн Read-Through с прогревом кеша при запуске приложения. Это позволит при первом входе на страницу оперативно подгружать данные из кеша. Паттерм можно реализовать с инвалидацией на основе изменений, чтобы кеш всегда содержал актуальные данные. В момент изменения данных, обновляем эти данные в кеше. Также можно скомбинировать этот паттерн с Write-Through, чтобы обновить данные в кеше после записи в бд.

Кеширование через Cache-Aside не подойдет, т.к. он работает по времени, и учитывая, что изменение может произойти в пределах этого времени, будут неактуальные данные. Также не подойдет паттерн Write-Behind, т.к. нам необходимо точно убедиться что запись сохранена.

```markdown
[Sequence diagram]()
```
